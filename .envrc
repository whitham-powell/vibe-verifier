# direnv configuration file
# Install direnv to automatically activate the virtual environment
# when entering this directory

# Check if uv is available
if command -v uv &> /dev/null; then
    UV_AVAILABLE=1
    PIP_CMD="uv pip"
else
    UV_AVAILABLE=0
    PIP_CMD="pip"
fi

# Create virtual environment if it doesn't exist
if [ ! -d ".venv" ]; then
    echo "Creating virtual environment..."
    if [ $UV_AVAILABLE -eq 1 ]; then
        uv venv .venv --python 3.10
    else
        python3 -m venv .venv
    fi
fi

# Activate virtual environment
source .venv/bin/activate

# Install development dependencies if needed
if [ ! -f ".venv/.dev_installed" ]; then
    echo "Installing development dependencies..."
    if [ $UV_AVAILABLE -eq 0 ]; then
        pip install --upgrade pip setuptools wheel
    fi
    $PIP_CMD install -r requirements-dev.txt
    $PIP_CMD install -e .
    touch .venv/.dev_installed
fi

# Set environment variables
export PYTHONPATH="${PYTHONPATH}:${PWD}"
export VIBE_VERIFIER_DEV=1

echo "Vibe Verifier development environment activated!"
echo "Python: $(which python)"
echo "Version: $(python --version)"